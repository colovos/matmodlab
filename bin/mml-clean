#!/usr/bin/env bash
# set up python environment
if [ -z "$MML_ROOT" ];  then
    echo >&2 "*** error: mml-clean: MML_ROOT environment variable not set"
    echo >&2 "this script should be called through matmodlab/bin/mml"
    echo >&2 "and not directly"
    exit 1
fi
usage()
{
cat << EOF
usage: mml-clean [-h]

Remove files generated by matmodlab (.pyc, .o, .so, .a, build, etc.)

EOF
}

# option parsing - for now, only -h is supported
while getopts "h" OPTION
do
     case $OPTION in
         h)
             usage
             exit 1
             ;;
         ?)
             usage
             exit
             ;;
     esac
done

find $MML_ROOT \( -type d -name "build" -o -type d -name "*.eval" \) \
                  -exec rm -rf {} \+
find $MML_ROOT \( -name "*.pyc" -o -name "*.o" -o \
                  -name "*.con" -o -name "*.a" -o \
                  -name "*-f2pywrappers2.f90" -o -name "*module.c" -o \
                  -name "*.so"  -o -name "*.log"  \) -exec rm -f {} \+
